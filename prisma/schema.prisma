// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
  binaryTargets = ["native", "rhel-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

enum BusinessType {
  PRODUCT
  SERVICE
  SUBSCRIPTION
  PLATFORM
  LICENSING
  RENTAL
  SHARING
  ADVERTISING
  IMPACT
}

enum BusinessStage {
  IDEA
  CONCEPT
  MVP
  VALIDATED
  GROWTH
  PIVOTING
}

enum BusinessArea {
  INDUSTRY
  COMMERCE
  SERVICES
  FINANCE
  TOURISM
  MEDIA
  CULTURE
}

enum BusinessSubarea {
  // INDUSTRY
  GOODS_PRODUCTION
  AGRIBUSINESS
  MINING
  CONSTRUCTION
  OTHER_INDUSTRY

  // COMMERCE
  RETAIL
  WHOLESALE
  FRANCHISE
  OTHER_COMMERCE

  // SERVICES
  HEALTH_WELLNESS
  EDUCATION
  CONSULTING
  TECHNOLOGY
  LOGISTICS
  LEGAL
  SPECIALIZED
  OTHER_SERVICES

  // FINANCE
  BANKING
  INSURANCE
  FINTECH
  STOCK_MARKET
  OTHER_FINANCE

  // TOURISM
  HOSPITALITY
  FOOD
  TRAVEL_AGENCY
  EVENTS
  OTHER_TOURISM

  // MEDIA
  ADVERTISING
  AUDIOVISUAL
  JOURNALISM
  DIGITAL_PLATFORMS
  INFO_MANAGEMENT
  PR
  OTHER_MEDIA

  // CULTURE
  ART_PRODUCTION
  LITERATURE
  MUSIC_AUDIO
  PERFORMING_ARTS
  HERITAGE
  CREATIVE_INDUSTRY
  OTHER_CULTURE
}

enum ModelType {
  B2B
  B2C
  B2G
  C2C
  C2B
  B2B2C
  G2C
}

enum CampaignStatus {
  DRAFT
  PUBLISHED
  COMPLETED
  CANCELLED
}

enum RepaymentUnit {
  WEEKS
  MONTHS
  YEARS
}

enum PaymentFrequency {
  WEEKLY
  MONTHLY
  BIMONTHLY
  QUARTERLY
  FOURMONTHLY
  SEMIANNUAL
  ANNUAL
  NONE
}

enum InterestType {
  FIXED
  VARIABLE
  MIXED
  NONE
}

enum DocType {
  CC
  PASSPORT
}

enum ProductPlan {
  BASIC
  PREMIUM
}

model User {
  id                    String      @id @default(uuid())
  email                 String      @unique
  name                  String?
  surnames              String?
  password              String
  productPlan           ProductPlan?
  emailVerified         Boolean?
  rememberToken         String?
  nif                   String?
  identificationDocType     DocType?
  identificationDocNumber   String?
  docExpiry             DateTime?
  address               String?
  postalCode            String?
  iban                  String?
  paypalEmail           String?
  createdAt             DateTime      @default(now())
  updatedAt             DateTime      @updatedAt
  campaigns             Campaign[]    @relation("UserCampaigns")
  investments           Investment[]  @relation("UserInvestments")
}

model Campaign {
  id                    String        @id @default(uuid())
  name                  String
  email                 String
  description           String?
  user                  User           @relation("UserCampaigns", fields: [userId], references: [id])
  userId                String
  businessType          BusinessType
  businessArea          BusinessArea
  businessSubarea       BusinessSubarea
  stage                 BusinessStage
  modelType             ModelType?
  capitalPlan           String?
  pitchLinks            String[]   
  mediaUrls             String[]   
  pitchDeckFiles        String[]   
  targetValue           Int        
  repaymentPeriod       Int
  repaymentUnit         RepaymentUnit
  paymentFrequency      PaymentFrequency
  gracePeriod           Int?
  interestType          InterestType
  interestRate          Float?
  euriborIndexed        Boolean?
  status                CampaignStatus   @default(DRAFT)
  createdAt             DateTime         @default(now())
  updatedAt             DateTime         @updatedAt
  investments           Investment[]     @relation("CampaignInvestments")
}

model Investment {
  id                    String           @id @default(uuid())
  campaignId            String
  campaign              Campaign          @relation("CampaignInvestments", fields: [campaignId], references: [id])
  investorId            String
  investor              User              @relation("UserInvestments", fields: [investorId], references: [id])
  amount                Int
  interestRate          Float
  repaymentPlan         String?
  paymentFrequency      PaymentFrequency
  repaymentPeriod       Int
  repaymentUnit         RepaymentUnit
  interestType          InterestType
  createdAt             DateTime          @default(now())
}
